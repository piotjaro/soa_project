<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
    <h:outputScript>
        function hide(id) {
            document.getElementById(id).style.display = "none";
        }

        function show(id) {
            document.getElementById(id).style.display = "inline";
        }

        function activeTab(id) {
            document.getElementById(id).className = "active";
        }


        function deactiveTab(id) {
            document.getElementById(id).className = "";
        }
    </h:outputScript>

</h:head>

<h:body>


    <div class="panel panel-primary">
        <div class="panel-heading">User panel
            <button class="btn btn-default" onclick="location.href = 'hello.xhtml';">Main Page</button>
        </div>

        <div class="panel-body">
            login: <h:outputLabel value="#{client.user.login}"/><br/>
            debt: <h:outputLabel value="#{client.user.debt}"/><br/>
            mail: <h:outputLabel value="#{client.user.mail}"/><br/>
            name: <h:outputLabel value="#{client.user.name}"/><br/>
            surname: <h:outputLabel value="#{client.user.surname}"/><br/>
            role: <h:outputLabel value="#{client.user.role}"/><br/>

        <ul class="nav nav-tabs">
            <li id="newTab" class="active"><a href="#"
                                              onclick="show('new'); hide('cancelled'); activeTab('newTab'); deactiveTab('cancelledTab')">new</a>
            </li>
            <li id="cancelledTab"><a href="#"
                                     onclick="show('cancelled'); hide('new'); activeTab('cancelledTab'); deactiveTab('newTab')">cancelled</a>
            </li>
        </ul>

        </div>
    </div>
    <div class="panel-group">
        <div id="new">
            <c:forEach items="#{client.user.actualCarts}" var="cart">
                <c:choose>
                    <c:when test="#{cart.status == 'New'}">
                        <div class="panel panel-success">
                        <div class="panel-heading">
                            <h:outputText value="Date of receipt: #{cart.dateOfReceipt}"/>
                            <h:outputText value=", total cost: #{cart.cost}"/>
                            <h:outputText value=", paid from salary: #{cart.paidFromSalary}"/>
                            <h:outputText value=", address: #{cart.address}"/>
                        </div>

                        <table class="table table-striped">
                            <ui:repeat value="#{cart.dishes}" var="dish">
                                <tr>
                                    <td>
                                        <h:outputLabel value="#{dish.name}"/>
                                        <h:form>
                                        <h:commandButton class="btn btn-default" action="#{client.removeDishFromCart(dish.id, cart.id)}"
                                                                                              value="remove dish"/>
                                        </h:form>
                                    </td>
                                </tr>
                            </ui:repeat>
                            <tr>
                            </tr>
                        </table>
                        <h:form>
                            <h:commandButton class="btn btn-default" action="#{client.goToAddDishFromMenu(cart.id)}"
                                             value="AddDish"/>
                            <h:commandButton class="btn btn-default" action="#{client.cancelCart(client.user.id, cart.id)}"
                                             value="Cancel cart"/>
                            <h:commandButton class="btn btn-default" action="#{client.payFromSalary(client.user.id, cart.id)}"
                                             value="pay from salary"/>
                            <h:commandButton class="btn btn-default" action="#{client.payCash(client.user.id, cart.id)}"
                                             value="pay cash"/>
                        </h:form>

                        </div>
                    </c:when>
                </c:choose>
            </c:forEach>
        </div>

        <div id="cancelled" style="display: none">
            <c:forEach items="#{client.user.actualCarts}" var="cart">
                <c:choose>
                    <c:when test="#{cart.status == 'Cancelled'}">
                        <div class="panel panel-danger">
                            <div class="panel-heading">
                                <h:outputText value="Date of receipt: #{cart.dateOfReceipt}"/>
                                <h:outputText value=", total cost: #{cart.cost}"/>
                                <h:outputText value=", paid from salary: #{cart.paidFromSalary}"/>
                                <h:outputText value=", address: #{cart.address}"/>
                            </div>

                            <table class="table table-striped">
                                <ui:repeat value="#{cart.dishes}" var="dish">
                                    <tr>
                                        <td>
                                            <h:outputLabel value="#{dish.name}"/>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </table>
                        </div>
                    </c:when>
                </c:choose>
            </c:forEach>
        </div>
    </div>


</h:body>


</html>